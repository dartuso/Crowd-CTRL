@page "/tournament-bracket"
@layout Shared.SocialLayout
@inject NavigationManager NavigationManager
@inject PageHistoryState PageHistoryState

@* https://grid.layoutit.com/?id=gWtsyNv  *@
<style>
.grid-container {
    margin: 40px;
    text-align: center;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  grid-template-rows: 1fr 1fr 1fr 1fr 1fr 1fr;
  gap: 0px 0px;
  grid-template-areas:
    ". T5 . ."
    "T1 O1 O3 ."
    "T2 O1 O3 FIN"
    "T3 O2 O4 FIN"
    "T4 O2 O4 ."
    ". T6 . BUTTONS";
}
.T5 { grid-area: T5;     margin: 50px;  align-self: center; }
.T6 { grid-area: T6;     margin: 50px;  align-self: center; }
.T1 { grid-area: T1;     margin: 50px;  align-self: center; }
.T2 { grid-area: T2;     margin: 50px;  align-self: center; }
.T3 { grid-area: T3;     margin: 50px;  align-self: center; }
.T4 { grid-area: T4;     margin: 50px;  align-self: center; }
.O1 { grid-area: O1;     margin: 50px;  align-self: center; }
.O2 { grid-area: O2;     margin: 50px;  align-self: center; }
.O3 { grid-area: O3;     margin: 50px;  align-self: center; }
.O4 { grid-area: O4;     margin: 50px;  align-self: center; }
.FIN { grid-area: FIN;     margin: 50px;  align-self: center; }
.BUTTONS {
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: 1fr 1fr 1fr;
  gap: 10px 0px;
  grid-template-areas:
    "B1"
    "B2"
    "B3";
  grid-area: BUTTONS;
}
.B1 { grid-area: B1; }
.B2 { grid-area: B2; }
.B3 { grid-area: B3; }
</style>


<h1 style="text-align:center; margin: 30px;">@(TournamentCreate._tournament.TournamentName)</h1>
<div class="grid-container">
    @foreach (ATeam team in TournamentCreate._tournament.TeamNames)
        {
            <button class="T@(team.teamNo)" id="t@(team.teamNo)" @onclick="() => selectWinner(team)">@(team.teamName)</button>
        }

  <button class="O1" @onclick="() => selectWinner(O1)">@(O1.teamName)</button>
  <button class="O2" @onclick="() => selectWinner(O2)">@(O2.teamName)</button>
  <button class="O3" @onclick="() => selectWinner(O3)">@(O3.teamName)</button>
  <button class="O4" @onclick="() => selectWinner(O4)">@(O4.teamName)</button>
  <button class="FIN">@(FIN.teamName)</button>
  <div class="BUTTONS">
    <div class="B1">
        <button class="btn btn-primary" @onclick="TournamentCreateNavigate">Edit tournament</button>
    </div>
    @* <div class="B2">
        <button class="btn btn-primary" @onclick="TournamentTeamsNavigate">Edit teams</button>
    </div> *@
    <div class="B2">
        <button class="btn btn-danger" @onclick="TournamentWinNavigate">End tournament</button>
    </div>
  </div>
</div>

@code {
    public static ATeam O1 = new ATeam(7, "");
    public static ATeam O2 = new ATeam(8, "");
    public static ATeam O3 = new ATeam(9, "");
    public static ATeam O4 = new ATeam(10, "");
    public static ATeam FIN = new ATeam(11, "");

    @* decided to remove this button, it can be done with edit tournament *@
    @* private void TournamentTeamsNavigate() 
    {
        NavigationManager.NavigateTo("tournament-teams");
        PageHistoryState.AddPageToHistory("tournament-bracket");
    } *@

    private void TournamentCreateNavigate()
    {
        NavigationManager.NavigateTo("tournament-create");
        PageHistoryState.AddPageToHistory("tournament-bracket");
    }

    private void TournamentWinNavigate()
    {
        NavigationManager.NavigateTo("tournament-win");
        PageHistoryState.AddPageToHistory("tournament-bracket");
    }

    public void selectWinner(ATeam team) {
        switch(team.teamNo) {
            case 1:
            case 2:
                O1.teamName = team.teamName;
                break;
            case 3:
            case 4:
                O2.teamName = team.teamName;
                break;
            case 5:
            case 7:
                O3.teamName = team.teamName;
                break;
            case 6:
            case 8:
                O4.teamName = team.teamName;
                break;
            case 9:
            case 10:
                FIN.teamName = team.teamName;
                break;
        }
    }
}